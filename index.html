<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Generador de Etiquetas • GoSpin</title>

<!-- Exportación a PDF -->
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>

<style>
  :root{ --ink:#0f172a; --muted:#64748b; --brand:#0ea5e9; }
  *{ box-sizing:border-box }
  body{ font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Helvetica,Arial,sans-serif; margin:0; background:#f6f7f9; color:var(--ink) }
  header{ display:flex; align-items:center; gap:14px; padding:16px 20px; background:#fff; border-bottom:1px solid #e6e8eb }
  header h1{ font-size:18px; margin:0; font-weight:800 }
  main{ display:grid; grid-template-columns: 420px 1fr; gap:20px; padding:20px; align-items:start }
  @media (max-width: 980px){ main{ grid-template-columns:1fr } }

  .card{ background:#fff; border:1px solid #e6e8eb; border-radius:14px; box-shadow:0 10px 20px rgba(0,0,0,.04) }
  .card .card-body{ padding:18px }

  /* -------- FORM LATERAL -------- */
  .field{ margin-bottom:12px }
  .field label{ display:block; font-size:12px; font-weight:800; margin-bottom:6px }
  .field input,.field textarea{ width:100%; border:1px solid #cfd3d7; border-radius:10px; font-size:14px }
  /* Coincidir altura con cuadros de la etiqueta (~11 mm) */
  .field input{ height:44px; padding:8px 12px; line-height:1.15; }
  .row .field input{ height:44px; }
  .field textarea{ min-height:64px; padding:10px 12px; line-height:1.15; resize:vertical; }

  .row{ display:grid; grid-template-columns:1fr 180px; gap:10px }

  .actions{ display:flex; flex-wrap:wrap; gap:10px; margin-top:8px }
  button{ appearance:none; border:0; background:var(--brand); color:#fff; padding:10px 14px; border-radius:10px; font-weight:800; cursor:pointer }
  button.secondary{ background:#e2e8f0; color:#0f172a }

  /* -------- PREVIEW 10×15 -------- */
  .preview-wrap{ display:flex; justify-content:center; align-items:flex-start; padding:16px }
  .preview{ width:100mm; height:150mm; background:#fff; color:#000; position:relative; border:1px solid #d1d5db }

  .label{
    position:absolute; inset:8mm;
    border:1.6px solid #000; padding:5mm;
    display:flex; flex-direction:column; gap:3.2mm;
  }
  .brand-row{ display:grid; grid-template-columns:1fr auto; align-items:center }
  .brand-title{ font-weight:900; font-size:12px; letter-spacing:.2px }
  .brand-logo{ width:23mm; height:auto; object-fit:contain }

  .fieldbox{ display:flex; flex-direction:column; gap:1mm }
  .flabel{ font-size:9.2px; font-weight:900 }
  .box{
    border:1px solid #000;
    padding:2.8mm;
    min-height:11mm;                 /* ~44px */
    font-size:12px; line-height:1.12;
    white-space:pre-wrap; word-wrap:break-word;
  }

  .row2{ display:grid; grid-template-columns: 1fr 30mm; gap:3mm; align-items:start }
  .cp .box{ font-weight:900; font-size:15px; text-align:left }
  .obs .box{ min-height:16mm }

  .website{ text-align:center; font-weight:900; font-size:11px; margin-top:auto }

  @page{ size: 100mm 150mm; margin: 0 }
  @media print{
    header, .card:not(.printable), .preview-wrap { display:none !important }
    body{ background:#fff }
    .preview{ border:0 }
    .label{ inset:0; border:0; padding:6.5mm }
  }
</style>
</head>
<body>
  <header class="card printable">
    <h1>Generador de Etiquetas (10×15 cm) • GoSpin</h1>
  </header>

  <main>
    <!-- PANEL DE CARGA (ayudas entre paréntesis SOLO aquí) -->
    <section class="card printable">
      <div class="card-body">
        <div class="field">
          <label>REMITENTE</label>
          <input id="f-remitente" maxlength="64" placeholder="(Ingresar únicamente nombre de comercio)"/>
        </div>
        <div class="field">
          <label>NOMBRE COMPLETO DE QUIEN RECIBE</label>
          <input id="f-nombre" maxlength="64" placeholder="(Nombre y Apellido)"/>
        </div>
        <div class="field">
          <label>DOMICILIO</label>
          <input id="f-domicilio" maxlength="90" placeholder="(Calle, Número, Piso/Departamento)"/>
        </div>
        <div class="row">
          <div class="field">
            <label>LOCALIDAD</label>
            <input id="f-localidad" maxlength="48" placeholder="(Ciudad/Localidad)"/>
          </div>
          <div class="field">
            <label>CÓDIGO POSTAL</label>
            <input id="f-cp" inputmode="numeric" maxlength="4" placeholder="(4 dígitos, ej. 1602)"/>
          </div>
        </div>
        <div class="field">
          <label>OBSERVACIONES</label>
          <textarea id="f-obs" rows="3" maxlength="220" placeholder="(Frágil, horario de entrega, portería, etc.)"></textarea>
        </div>

        <div class="actions">
          <button id="btn-pdf">Descargar PDF</button>
          <button id="btn-clear" class="secondary">Nueva etiqueta</button>
        </div>
        <p style="font-size:12px; color:#475569; margin-top:10px">
          CP validado: sólo números y exactamente 4 dígitos. Los datos no se envían a ningún servidor.
        </p>
      </div>
    </section>

    <!-- VISTA PREVIA (lo que se imprime) -->
    <section class="card">
      <div class="preview-wrap">
        <div class="preview" id="preview">
          <div class="label" id="label">
            <div class="brand-row">
              <div class="brand-title">Etiqueta de Envío • GoSpin</div>
              <img src="gospinlogo.png" alt="GoSpin" class="brand-logo" />
            </div>

            <div class="fieldbox remitente">
              <div class="flabel">REMITENTE</div>
              <div class="box" id="v-remitente"></div>
            </div>

            <div class="fieldbox nombre">
              <div class="flabel">NOMBRE COMPLETO DE QUIEN RECIBE</div>
              <div class="box" id="v-nombre"></div>
            </div>

            <div class="fieldbox domicilio">
              <div class="flabel">DOMICILIO</div>
              <div class="box" id="v-domicilio"></div>
            </div>

            <div class="row2">
              <div class="fieldbox loc">
                <div class="flabel">LOCALIDAD</div>
                <div class="box" id="v-localidad"></div>
              </div>
              <div class="fieldbox cp">
                <div class="flabel">CÓDIGO POSTAL</div>
                <div class="box" id="v-cp"></div>
              </div>
            </div>

            <div class="fieldbox obs">
              <div class="flabel">OBSERVACIONES</div>
              <div class="box" id="v-obs"></div>
            </div>

            <div class="website">WWW.GOSPIN.COM.AR</div>
          </div>
        </div>
      </div>
    </section>
  </main>

<script>
  function $(id){ return document.getElementById(id); }
  function getVal(id){ return ($(id).value || '').trim(); }

  // CP: sólo números (máx 4)
  $('f-cp').addEventListener('input', (e)=>{
    e.target.value = e.target.value.replace(/[^0-9]/g,'').slice(0,4);
  });

  function validateCP(){
    const cp = getVal('f-cp');
    const ok = /^\d{4}$/.test(cp);
    $('f-cp').style.borderColor = ok ? '#cfd3d7' : '#ef4444';
    return ok;
  }

  function sync(){
    $('v-remitente').textContent = getVal('f-remitente');
    $('v-nombre').textContent    = getVal('f-nombre');
    $('v-domicilio').textContent = getVal('f-domicilio');
    $('v-localidad').textContent = getVal('f-localidad');
    $('v-cp').textContent        = getVal('f-cp');
    $('v-obs').textContent       = getVal('f-obs');
    validateCP();
  }

  ['f-remitente','f-nombre','f-domicilio','f-localidad','f-cp','f-obs'].forEach(id=>{
    $(id).addEventListener('input', sync);
  });

  // Descargar PDF
  async function descargarPDF(){
    if(!validateCP()){ alert('El Código Postal debe tener 4 números.'); return; }
    sync();
    const el = $('preview');
    const canvas = await html2canvas(el, {scale:2, backgroundColor:'#ffffff'});
    const imgData = canvas.toDataURL('image/png');
    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF({ orientation:'p', unit:'mm', format:[100,150] });
    pdf.addImage(imgData, 'PNG', 0, 0, 100, 150);
    const nombre = getVal('f-nombre').replace(/[^A-Za-z0-9_\-]+/g,'_') || 'etiqueta';
    const cp = getVal('f-cp') || '0000';
    pdf.save(`etiqueta_gospin_${cp}_${nombre}.pdf`);
  }
  $('btn-pdf').addEventListener('click', descargarPDF);

  // Nueva etiqueta (limpiar)
  $('btn-clear').addEventListener('click', ()=>{
    ['f-remitente','f-nombre','f-domicilio','f-localidad','f-cp','f-obs'].forEach(id=>{
      $(id).value = '';
    });
    sync();
    $('f-remitente').focus();
  });

  // Inicial
  sync();
</script>
</body>
</html>
